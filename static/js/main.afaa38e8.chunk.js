(this["webpackJsonpmy-project"]=this["webpackJsonpmy-project"]||[]).push([[0],{13:function(e,t,n){e.exports={login:"login_login__1o6vM",form:"login_form__3gELR",input:"login_input__3z1dB",label:"login_label__36RvX",error:"login_error__ToPy9",btn:"login_btn__10Cqc"}},26:function(e,t,n){e.exports={profile:"profile_profile__2Y0iQ",btn:"profile_btn__3KVxx"}},27:function(e,t,n){e.exports={ldsCss:"spinner_ldsCss__3qJzW",ldsDoubleRing:"spinner_ldsDoubleRing__Ih7qI",ldsDoubleRing_reverse:"spinner_ldsDoubleRing_reverse__1-91A"}},48:function(e,t,n){},49:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(19),c=n.n(r),s=(n(48),n(49),n(18)),o=n(3),l=n(26),u=n.n(l),d=n(11),j=n(12),b=n(39),f=n.n(b).a.create({baseURL:"https://tager.dev.ozitag.com"}),p=function(e){return f.post("/api/auth/user",e)},h=function(e){return f.get("/api/tager/user/profile",{headers:{Authorization:"Bearer ".concat(e)}})},O=function(e){return f.post("/api/tager/user/profile/logout",{},{headers:{Authorization:"Bearer ".concat(e)}})},g="login/SET-IS-LOGGED-IN",m="login/SET_DATA",x="login/SET-IS-INITIALIZED",v={isLoggedIn:!1,accessToken:"",profileData:{},isInitialized:!1},_=function(e,t){return{type:g,value:e,token:t}},I=function(e){return{type:x,isInitialized:e}},N=function(){return function(e,t){e(I(!0));var n=t().auth.accessToken;h(n).then((function(t){var n;e((n=t.data.data,{type:m,data:n}))})).catch((function(e){alert(e.response.data.message)})).finally((function(){e(I(!1))}))}},y=n(27),S=n.n(y),w=n(1),T=function(){return Object(w.jsx)("div",{className:S.a.ldsCss,children:Object(w.jsxs)("div",{className:S.a.ldsDoubleRing,children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{})]})})},D=function(){var e=Object(d.c)((function(e){return e.auth.isLoggedIn})),t=Object(d.c)((function(e){return e.auth.profileData})),n=Object(d.c)((function(e){return e.auth.isInitialized})),i=Object(d.b)();Object(a.useEffect)((function(){e||i(N())}),[i]);return e?n?Object(w.jsx)(T,{}):Object(w.jsxs)("div",{className:u.a.profile,children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:t.email}),Object(w.jsx)("div",{children:t.name})]}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:u.a.btn,onClick:function(){i((function(e,t){var n=t().auth.accessToken;e(I(!0)),O(n).then((function(t){e(_(!0,n))})).catch((function(e){alert(e.response.data.message)})).finally((function(){e(I(!1))}))}))},children:"LogOut"})})]}):Object(w.jsx)(o.a,{to:"/login"})},A=n(43),L=n(13),k=n.n(L),z=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.auth.isLoggedIn})),n=Object(A.a)({initialValues:{clientId:1,email:"",password:""},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="\u041f\u043e\u043b\u0435 email \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c",e.password?e.password.length<3&&(t.password="\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u0435\u0435 3 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):t.password="Required",t},onSubmit:function(t){var a;e((a=t,function(e){e(I(!0)),p(a).then((function(t){e(_(!0,t.data.data.accessToken)),e(N())})).catch((function(e){alert(e.response.data.message)})).finally((function(){e(I(!1))}))})),n.resetForm()}});return t?Object(w.jsx)(o.a,{to:"/"}):Object(w.jsx)("div",{className:k.a.login,children:Object(w.jsxs)("form",{onSubmit:n.handleSubmit,className:k.a.form,children:[Object(w.jsx)("label",{htmlFor:"email",className:k.a.label,children:"Email Address"}),Object(w.jsx)("input",Object(j.a)({className:k.a.input,id:"email",type:"email"},n.getFieldProps("email"))),n.touched.email&&n.errors.email?Object(w.jsx)("div",{className:k.a.error,children:n.errors.email}):null,Object(w.jsx)("label",{htmlFor:"email",className:k.a.label,children:"Password"}),Object(w.jsx)("input",Object(j.a)({className:k.a.input,id:"password",type:"password"},n.getFieldProps("password"))),n.touched.password&&n.errors.password?Object(w.jsx)("div",{className:k.a.error,children:n.errors.password}):null,Object(w.jsx)("button",{type:"submit",className:k.a.btn,children:"Submit"})]})})},E=function(){return Object(w.jsx)("div",{children:Object(w.jsxs)(o.d,{children:[Object(w.jsx)(o.b,{path:"/",exact:!0,render:function(){return Object(w.jsx)(D,{})}}),Object(w.jsx)(o.b,{path:"/login",render:function(){return Object(w.jsx)(z,{})}}),Object(w.jsx)(o.b,{path:"*",render:function(){return Object(w.jsx)("h1",{children:"404: PAGE NOT FOUND"})}})]})})};var F=function(){return Object(w.jsx)("div",{children:Object(w.jsx)(s.a,{children:Object(w.jsx)(E,{})})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,74)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))},C=n(23),P=n(42),B=Object(C.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(j.a)(Object(j.a)({},e),{},{isLoggedIn:t.value,accessToken:t.token});case m:return Object(j.a)(Object(j.a)({},e),{},{profileData:t.data});case x:return Object(j.a)(Object(j.a)({},e),{},{isInitialized:t.isInitialized});default:return e}}}),J=Object(C.c)(B,function(){try{var e=localStorage.getItem("app-state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),Object(C.a)(P.a));J.subscribe((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("app-state",t)}catch(n){}}({auth:J.getState().auth})})),c.a.render(Object(w.jsx)(i.a.StrictMode,{children:Object(w.jsx)(d.a,{store:J,children:Object(w.jsx)(F,{})})}),document.getElementById("root")),R()}},[[73,1,2]]]);
//# sourceMappingURL=main.afaa38e8.chunk.js.map